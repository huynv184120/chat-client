{"ast":null,"code":"var _jsxFileName = \"/home/huy/chat-module/chat-client/src/component/chatwindow/ListMessages.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { Message } from \"./message\";\nimport { makeStyles } from \"@material-ui/core\";\nimport { memo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport Cookies from 'js-cookie';\nimport { useRef } from \"react\";\nimport { useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(() => ({\n  messagesContainer: {\n    height: \"calc(100vh - 284px)\",\n    overflowY: \"auto\",\n    overflowX: \"hidden\",\n    marginTop: \"20px\",\n    marginBottom: \"20px\",\n    position: \"relative\"\n  }\n}));\n\nconst ListMessages = _ref => {\n  _s();\n\n  var _listMessages$filter$;\n\n  let {\n    socket\n  } = _ref;\n  const mess_count = useRef(0);\n  const bottom = useRef(null);\n  const classes = useStyles();\n  const listMessages = useSelector(state => state.message.listMessages);\n  const currentRoom = useSelector(state => state.room.currentRoom);\n  const currentRoomMess = ((_listMessages$filter$ = listMessages.filter(oj => oj.room_id === currentRoom)[0]) === null || _listMessages$filter$ === void 0 ? void 0 : _listMessages$filter$.messages) || [];\n  const users = useSelector(state => state.user.listUsers);\n  const self = Cookies.get('user_id').split('\"')[1];\n  mess_count.current = currentRoomMess.length;\n\n  for (let i = currentRoomMess.length - 1; i > 0; i = i - 1) {\n    if (currentRoomMess[i].from !== self) {\n      currentRoomMess[i].notSelf = true;\n\n      if (currentRoomMess[i].from !== currentRoomMess[i - 1].from) {\n        currentRoomMess[i].user = users.find(user => user._id === currentRoomMess[i].from);\n      }\n    } else {\n      currentRoomMess[i].notSelf = false;\n    }\n  }\n\n  if (currentRoomMess.length >= 1 && currentRoomMess[0].from !== self) {\n    currentRoomMess[0].user = users.find(user => user._id === currentRoomMess[0].from);\n    currentRoomMess[0].notSelf = true;\n  }\n\n  useEffect(() => {\n    bottom.current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [currentRoom, mess_count.current]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.messagesContainer,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        minHeight: \"40px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this), currentRoomMess.map(mess => /*#__PURE__*/_jsxDEV(Message, {\n      id: mess._id,\n      content: mess.content,\n      user: mess.user,\n      reactions: mess.reactions,\n      notSelf: mess.notSelf,\n      createdAt: mess.createdAt,\n      deleted: mess.deleted,\n      socket: socket\n    }, mess._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 44\n    }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: bottom\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ListMessages, \"RfCrJS9ymTUS9j4xKhy/4RdJ1Us=\", false, function () {\n  return [useStyles, useSelector, useSelector, useSelector];\n});\n\n_c = ListMessages;\nexport default _c2 = /*#__PURE__*/memo(ListMessages);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ListMessages\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","Message","makeStyles","memo","useSelector","Cookies","useRef","useEffect","useStyles","messagesContainer","height","overflowY","overflowX","marginTop","marginBottom","position","ListMessages","socket","mess_count","bottom","classes","listMessages","state","message","currentRoom","room","currentRoomMess","filter","oj","room_id","messages","users","user","listUsers","self","get","split","current","length","i","from","notSelf","find","_id","scrollIntoView","behavior","minHeight","map","mess","content","reactions","createdAt","deleted"],"sources":["/home/huy/chat-module/chat-client/src/component/chatwindow/ListMessages.js"],"sourcesContent":["import React from \"react\";\nimport { Message } from \"./message\";\nimport { makeStyles } from \"@material-ui/core\";\nimport { memo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport Cookies from 'js-cookie';\nimport { useRef } from \"react\";\nimport { useEffect } from \"react\";\nconst useStyles = makeStyles(() => ({\n    messagesContainer: {\n        height: \"calc(100vh - 284px)\",\n        overflowY: \"auto\",\n        overflowX: \"hidden\",\n        marginTop: \"20px\",\n        marginBottom: \"20px\",\n        position: \"relative\"\n    }\n}))\n\n\nconst ListMessages = ({socket}) => {   \n    const mess_count = useRef(0);\n    const bottom = useRef(null);\n    const classes = useStyles();\n    const listMessages = useSelector(state => state.message.listMessages)\n    const currentRoom = useSelector(state => state.room.currentRoom);\n    const currentRoomMess = (listMessages.filter((oj) => oj.room_id === currentRoom))[0]?.messages || [];\n    const users = useSelector(state => state.user.listUsers);\n    const self = Cookies.get('user_id').split('\"')[1];\n    mess_count.current = currentRoomMess.length;\n    for (let i = currentRoomMess.length - 1; i > 0; i=i-1) {\n        if ((currentRoomMess[i].from !== self)) {\n            currentRoomMess[i].notSelf = true;\n            if (currentRoomMess[i].from !== currentRoomMess[i - 1].from) {\n                currentRoomMess[i].user = users.find((user) => user._id === currentRoomMess[i].from)\n            }\n        }else{\n            currentRoomMess[i].notSelf = false;            \n        }\n    }\n    if ((currentRoomMess.length >=1) && (currentRoomMess[0].from !== self)) {\n        currentRoomMess[0].user = users.find((user) => user._id === currentRoomMess[0].from);\n        currentRoomMess[0].notSelf = true;\n    }\n    useEffect(() => {\n        bottom.current.scrollIntoView({behavior:\"smooth\"});\n    }, [currentRoom, mess_count.current]);\n    \n\n    return (\n        <div className={classes.messagesContainer}>\n            <div style={{minHeight:\"40px\"}}></div>\n            {currentRoomMess.map((mess) => <Message key={mess._id} id={mess._id} content={mess.content} user={mess.user} reactions={mess.reactions} notSelf={mess.notSelf} createdAt={mess.createdAt} deleted={mess.deleted} socket={socket}/>)}\n            <div ref={bottom}/>\n        </div>);\n}\n\nexport default memo(ListMessages);"],"mappings":"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"},"metadata":{},"sourceType":"module"}