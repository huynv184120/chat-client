{"ast":null,"code":"import _objectSpread from \"/home/huy/chat-module/chat-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/home/huy/chat-module/chat-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { mess_action_type } from \"../actions/message\";\nvar initState = {\n  listMessages: []\n};\n\nvar messageReducer = function messageReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case mess_action_type.addMessage:\n      {\n        var roomMessage = state.listMessages.find(function (oj) {\n          return action.data.to === oj.room_id;\n        });\n\n        if (roomMessage) {\n          if (roomMessage.messages.length === 0 || roomMessage.messages[roomMessage.messages.length - 1]._id !== action.data._id) {\n            roomMessage.messages = [].concat(_toConsumableArray(roomMessage.messages), [action.data]);\n            state.listMessages = _toConsumableArray(state.listMessages);\n          }\n        } else {\n          state.listMessages = [].concat(_toConsumableArray(state.listMessages), [{\n            room_id: action.data.to,\n            messages: [action.data]\n          }]);\n        }\n\n        return _objectSpread({}, state);\n      }\n\n    case mess_action_type.deleteMessage:\n      {\n        var _roomMessage = state.listMessages.find(function (oj) {\n          return action.data.room._id === oj.room._id;\n        });\n\n        if (_roomMessage) {\n          _roomMessage.messages = _roomMessage.messages.filter(function (mess) {\n            return mess._id !== action.data.message._id;\n          });\n        }\n\n        return _objectSpread({}, state);\n      }\n\n    case mess_action_type.loadMessages:\n      {\n        state.listMessages = [].concat(_toConsumableArray(state.listMessages), [{\n          room_id: action.data.room_id,\n          messages: action.data.messages\n        }]);\n        return _objectSpread({}, state);\n      }\n\n    case mess_action_type.updateMessage:\n      {\n        var _roomMessage2 = state.listMessages.find(function (oj) {\n          return action.data.to === oj.room_id;\n        });\n\n        var index = _roomMessage2.messages.findIndex(function (mess) {\n          return mess._id == action.data._id;\n        });\n\n        _roomMessage2.messages[index] = action.data;\n        state.listMessages = _toConsumableArray(state.listMessages);\n        return _objectSpread({}, state);\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n};\n\nexport default messageReducer;","map":{"version":3,"names":["mess_action_type","initState","listMessages","messageReducer","state","action","type","addMessage","roomMessage","find","oj","data","to","room_id","messages","length","_id","deleteMessage","room","filter","mess","message","loadMessages","updateMessage","index","findIndex"],"sources":["/home/huy/chat-module/chat-client/src/redux/reducers/message.js"],"sourcesContent":["import { mess_action_type } from \"../actions/message\"\n\nconst initState = {\n    listMessages: []\n};\n\nconst messageReducer = (state = initState, action) => {\n    switch (action.type) {\n        case mess_action_type.addMessage: {\n            const roomMessage = state.listMessages.find((oj) => action.data.to === oj.room_id);\n            if (roomMessage) {\n                if((roomMessage.messages.length === 0)||(roomMessage.messages[roomMessage.messages.length-1]._id !== action.data._id)){\n                    roomMessage.messages = [...roomMessage.messages, action.data];\n                    state.listMessages = [...state.listMessages];\n                }\n            } else {\n                state.listMessages = [...state.listMessages, { room_id: action.data.to, messages: [action.data] }]\n            }\n            return { ...state };\n        }\n\n        case mess_action_type.deleteMessage: {\n            const roomMessage = state.listMessages.find((oj) => action.data.room._id === oj.room._id);\n            if (roomMessage) {\n                roomMessage.messages = roomMessage.messages.filter((mess) => mess._id !== action.data.message._id);\n            }\n            return { ...state };\n        }\n        case mess_action_type.loadMessages: {\n            state.listMessages = [...state.listMessages, { room_id: action.data.room_id, messages: action.data.messages }];\n            return { ...state };\n        }\n        case mess_action_type.updateMessage: {\n            const roomMessage = state.listMessages.find((oj) => action.data.to === oj.room_id);\n            const index = roomMessage.messages.findIndex((mess) => (mess._id == action.data._id));\n            roomMessage.messages[index] = action.data;\n            state.listMessages = [...state.listMessages];\n            return {...state};\n        }\n        default: {\n            return state;\n        }\n    }\n}\n\nexport default messageReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}