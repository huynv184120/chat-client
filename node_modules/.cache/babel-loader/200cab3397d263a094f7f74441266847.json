{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"/home/huy/chat-module/chat-client/src/component/chatwindow/ListMessages.js\";\n\nimport React from \"react\";\nimport { Message } from \"./message\";\nimport { makeStyles } from \"@material-ui/core\";\nimport { memo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport Cookies from 'js-cookie';\nimport { useRef } from \"react\";\nimport { useEffect } from \"react\";\nvar useStyles = makeStyles(function () {\n  return {\n    messagesContainer: {\n      height: \"calc(100vh - 284px)\",\n      overflowY: \"auto\",\n      overflowX: \"hidden\",\n      marginTop: \"20px\",\n      marginBottom: \"20px\",\n      position: \"relative\"\n    }\n  };\n});\n\nvar ListMessages = function ListMessages(_ref) {\n  var socket = _ref.socket;\n  var mess_count = useRef(0);\n  var bottom = useRef(null);\n  var classes = useStyles();\n  var listMessages = useSelector(function (state) {\n    return state.message.listMessages;\n  });\n  var currentRoom = useSelector(function (state) {\n    return state.room.currentRoom;\n  });\n  var currentRoomMess = listMessages.filter(function (oj) {\n    return oj.room_id === currentRoom;\n  })[0]?.messages || [];\n  var users = useSelector(function (state) {\n    return state.user.listUsers;\n  });\n  var self = Cookies.get('user_id').split('\"')[1];\n  mess_count.current = currentRoomMess.length;\n\n  var _loop = function _loop(i) {\n    if (currentRoomMess[i].from !== self) {\n      currentRoomMess[i].notSelf = true;\n\n      if (currentRoomMess[i].from !== currentRoomMess[i - 1].from) {\n        currentRoomMess[i].user = users.find(function (user) {\n          return user._id === currentRoomMess[i].from;\n        });\n      }\n    } else {\n      currentRoomMess[i].notSelf = false;\n    }\n  };\n\n  for (var i = currentRoomMess.length - 1; i > 0; i = i - 1) {\n    _loop(i);\n  }\n\n  if (currentRoomMess.length >= 1 && currentRoomMess[0].from !== self) {\n    currentRoomMess[0].user = users.find(function (user) {\n      return user._id === currentRoomMess[0].from;\n    });\n    currentRoomMess[0].notSelf = true;\n  }\n\n  useEffect(function () {\n    bottom.current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [currentRoom, mess_count.current]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.messagesContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      minHeight: \"40px\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }\n  }), currentRoomMess.map(function (mess) {\n    return /*#__PURE__*/React.createElement(Message, {\n      key: mess._id,\n      id: mess._id,\n      content: mess.content,\n      user: mess.user,\n      reactions: mess.reactions,\n      notSelf: mess.notSelf,\n      createdAt: mess.createdAt,\n      deleted: mess.deleted,\n      socket: socket,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 44\n      }\n    });\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ref: bottom,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }\n  }));\n};\n\nexport default memo(ListMessages);","map":{"version":3,"names":["React","Message","makeStyles","memo","useSelector","Cookies","useRef","useEffect","useStyles","messagesContainer","height","overflowY","overflowX","marginTop","marginBottom","position","ListMessages","socket","mess_count","bottom","classes","listMessages","state","message","currentRoom","room","currentRoomMess","filter","oj","room_id","messages","users","user","listUsers","self","get","split","current","length","i","from","notSelf","find","_id","scrollIntoView","behavior","minHeight","map","mess","content","reactions","createdAt","deleted"],"sources":["/home/huy/chat-module/chat-client/src/component/chatwindow/ListMessages.js"],"sourcesContent":["import React from \"react\";\nimport { Message } from \"./message\";\nimport { makeStyles } from \"@material-ui/core\";\nimport { memo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport Cookies from 'js-cookie';\nimport { useRef } from \"react\";\nimport { useEffect } from \"react\";\nconst useStyles = makeStyles(() => ({\n    messagesContainer: {\n        height: \"calc(100vh - 284px)\",\n        overflowY: \"auto\",\n        overflowX: \"hidden\",\n        marginTop: \"20px\",\n        marginBottom: \"20px\",\n        position: \"relative\"\n    }\n}))\n\n\nconst ListMessages = ({socket}) => {   \n    const mess_count = useRef(0);\n    const bottom = useRef(null);\n    const classes = useStyles();\n    const listMessages = useSelector(state => state.message.listMessages)\n    const currentRoom = useSelector(state => state.room.currentRoom);\n    const currentRoomMess = (listMessages.filter((oj) => oj.room_id === currentRoom))[0]?.messages || [];\n    const users = useSelector(state => state.user.listUsers);\n    const self = Cookies.get('user_id').split('\"')[1];\n    mess_count.current = currentRoomMess.length;\n    for (let i = currentRoomMess.length - 1; i > 0; i=i-1) {\n        if ((currentRoomMess[i].from !== self)) {\n            currentRoomMess[i].notSelf = true;\n            if (currentRoomMess[i].from !== currentRoomMess[i - 1].from) {\n                currentRoomMess[i].user = users.find((user) => user._id === currentRoomMess[i].from)\n            }\n        }else{\n            currentRoomMess[i].notSelf = false;            \n        }\n    }\n    if ((currentRoomMess.length >=1) && (currentRoomMess[0].from !== self)) {\n        currentRoomMess[0].user = users.find((user) => user._id === currentRoomMess[0].from);\n        currentRoomMess[0].notSelf = true;\n    }\n    useEffect(() => {\n        bottom.current.scrollIntoView({behavior:\"smooth\"});\n    }, [currentRoom, mess_count.current]);\n    \n\n    return (\n        <div className={classes.messagesContainer}>\n            <div style={{minHeight:\"40px\"}}></div>\n            {currentRoomMess.map((mess) => <Message key={mess._id} id={mess._id} content={mess.content} user={mess.user} reactions={mess.reactions} notSelf={mess.notSelf} createdAt={mess.createdAt} deleted={mess.deleted} socket={socket}/>)}\n            <div ref={bottom}/>\n        </div>);\n}\n\nexport default memo(ListMessages);"],"mappings":"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"},"metadata":{},"sourceType":"module"}